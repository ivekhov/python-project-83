## ToDo:


- [x] в шаблонах везде использовать url_for(...) для формирования ссылок на приложение. Есть еще пара мест


- [x] глобальные переменные вообще не очень хорошо с точки зрения тестирования, их значение сложнее подменить на тестовый репозиторий например. 
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L28

В эталонном репозитории от Хекслета в курсе по Фласку ровно так и сделано - глобальная переменная. Я на него и ориентировался. Если в эталонном проекте используется нехорошая практика, то нужно его исправить, наверное? Как тогда нужно делать, если не через глобальную переменную? Можно пример? 
https://github.com/hexlet-components/python-flask-example/blob/d744dbed11ebd1fcfee86a44ea8e8e55c83b5a0f/example.py#L17


- [x] тут ты всегда берешь только первую ошибку, но их может быть потом добавлено еще несколько. Лучше тут организовать цикл по errors и для каждой ошибки свой flash()
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L78

- [x] по названию переменной непонятно что в ней находится, result слишком общее слово.
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L84


- [x] id не самое удачное название для переменной оно перекрывает стандартную функцию id(). И тут не всегда из контекста понятно, что такое id. Лучше полностью назвать url_id
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L89


- [x] если метод возвращает url_details, то и переменную надо назвать, иначе непонятно что в ней лежит, толи обычная сущность url, толи что-то новое с дополнительной информацией.
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L104


- [x] не уверен как правильно с английской точки зрения, но обычно во множественное число ставят только второе существительное - url_checks. Но можно оставить и так.

- [x] И стараться везде унифицировано использовать имя сущности - или url_check или check. Иначе непонятно новая эта сущность, или просто сокращение от существующей.

- [x] req - слишком общее название. Судя по названию метода должен возвращаться url
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L116

- [x] это не parsed_url - это скорее parsed content или page. Parsed_url говорит скорее о том что функция разбирает строку адреса на составные части.
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L129

- [?] если функция save_check - она сохраняет в бд сущности url_check. А тут на вход подается судя по названию parsed_url
https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/app.py#L133
НЕ ПРИНЯТ КОММЕНТАРИЙ: 
Непонятный комментарий. В процессе парсинга страницы функция parse_url() из parser берет нужную часть контента страницы для записи в БД согласно заданию. Далее этот результат сохраняется с помощью функции repo.save_checks(). В чем суть комментария? переименовать переменную или логику записи в БД переделать? На мой взгляд, уже рекомендуются избыточные телодвижения и высасывание из пальца. 

- [ ] использование такого подхода заставляет при вызове каждой функции окрывать новое соединение, открывать транзакцию, закрывать её и соединение в конце.
Иногда нужно выполнить несколько операций в рамках одной транзакции и откатить их все если что-то пошло не так. Поэтому транзакцию обычно открывают в начале первой операций пользователя и закрывают в конце последней. или делают откат.
По хорошему у тебя должен быть метод, открывающий соединение, он должен вызывать в начале обработчиков в app.py. Затем это соединение должно передаваться во все методы repo первым параметром. И когда все нужные методы выполненые, для этого соединения должен вызываться close(), который вызовет commit транзакции.

https://github.com/ivekhov/python-project-83/blob/ca6373bb5f62616a7b80b666bcef81cc61a1287c/page_analyzer/url_repository.py#L14-L28
НЕ ПРИНЯТ КОММЕНТАРИЙ: 
Противоречивые советы от разных наставников. Один рекомендует сделать класс и методы внутри, другой - декоратор, третий говорит "Все не так, нужно переделать". Нет уж, хватит.







---------


## Fixed 

- [x] выделить данные, используемые для инициализации бд в отдельный файл (фикстуру)

- [x] зависимости будет правильнее указать в dev группе. Зависимости flake8 и isort при этом можно совсем удалить, так как они не используются в Makefile.

- [x] TODO.md 

- [x] избавиться от классов DatabaseConnection и DatabaseCursor.

- [x] удалить обработчик ConnectionError из page_analyzer.app

- [x] определить декоратор, который будет инциализировать курсор и передавать его в оборачиваемую функцию – это сократит количество кода в UrlRepository.

- [x] Именование функции должно начинаться с глагола в неопределенной форме

- [x] описание аргументов и возвращаемых значений можно удалить из docstring'а – эти функции обычно никогда не вызываются напрямую

- [x] Обработчики GET и POST запросов будет правильнее разделить на отдельные функции.

- [x] Postgres гарантирует, что в случае успешного выполнения INSERT данные будут записаны, поэтому этот запрос можно удалить – это ускорит работу этого обработчика, так сетевые запросы являются самыми медленными операциями. - Нет, его удалить нельзя, т к это запрос на получение id

- [x] ошибки работы с БД не нужно отлавливать, так как в этом случае приложение должно вернуть 500 код в ответе.

- [x] Для этого метода лучше выбрать более конкретное название (так как можно сказать, что любые данные в этом приложении – это content).

- [x] В случае, если указанный ресурс не был найден, приложение должно вернуть код ошибки 404

- [x] должно быть реализовано такое же поведение, как в эталонном проекте (рекомендую проанализировать его в dev tools браузера).

- [x] Название этого модуля можно сократить до urls.

- [x] функцию лучше вынести в отдельный модуль и сделать ее чистой (по аналогии с обычными процедурами парсинга) – сделать так, чтобы она принимала только один аргумент в виде строки с содержимым тела.


### Ideas 

- [ ] Тесты - ? 

- [ ] В декораторе курсора к бд не создавать+тушить каждый раз коннектор к бд, а только курсор? Но тогда нужен +1 действие (где-то) для открытия+закрытия этого коннектора; В целом вопрос: ок ли практика открывать+закрывать коннектор к бд на каждом действии с базой? 

- [ ] Встроить объект логгера с переключением режима в начале файла или при запуске проекта c помощью ключа /аргумента/ 


